class Clara{static prevWidth=null;static projects=[{id:"una-cosa-bianca",img:"img/una-cosa-bianca/una-cosa-bianca-1.jpg",height:250,year:"2024-2025",title:"Una cosa bianca"},{id:"intima-materia",video:"img/intima-materia/intima-materia.mp4",height:250,year:"2023",title:"Intima Materia"},{id:"la-forme-fermee",img:"img/la-forme-fermee/la-forme-fermee-1.jpg",height:310,year:"2021",title:"La forme fermèe"},{id:"sedimenti",img:"img/sedimenti/sedimenti-1.jpg",height:400,year:"2021",title:"Sedimenti"},{id:"faccia",video:"img/faccia/faccia.mp4",height:180,year:"2019",title:"Io sono l'altra faccia di te"},{id:"300-grammi",video:"img/300-grammi/300-grammi.mp4",height:400,year:"2019",title:"300 grammi"},{id:"ex-voto",img:"img/ex-voto/ex-voto-1.jpg",height:350,year:"2019",title:"Ex Voto"},{id:"legami",img:"img/legami/legami-1.jpg",height:250,year:"2018",title:"Legami"},{id:"lettera-occhi",img:"img/lettera-occhi/lettera-occhi-1.jpg",height:310,year:"2018",title:"Lettera dai Tuoi Occhi"},{id:"attraverso",img:"img/attraverso/attraverso-1.jpg",height:400,year:"2018",title:"Attraverso"},{id:"vanitas",img:"img/vanitas/vanitas-1.jpg",height:180,year:"2018",title:"Vanitas Vanitatum et Omnia Vanitas"},{id:"no-violence",img:"img/no-violence/no-violence-1.jpg",height:400,year:"2018",title:"Image no violence on woman"},{id:"ricorda",img:"img/ricorda/ricorda-1.jpg",height:350,year:"2017",title:"Ricorda di essere stato straniero"},{id:"mnemosine",img:"img/mnemosine/mnemosine-1.jpg",height:200,year:"2016-2017",title:"Mnemosine"},{id:"chrysalis",img:"img/chrysalis/chrysalis-13.jpg",height:200,year:"2016",title:"Chrysalis"},{id:"radici",img:"img/radici/radici-1.jpg",height:200,year:"2015-2016",title:"Radici"}];static init(){Clara.setYear(),window.addEventListener("popstate",(()=>{Clara.view()})),window.addEventListener("load",Clara.renderProjects),Clara.view()}static async view(e=null){if(document.querySelector(".lightbox-overlay")?.remove(),e)history.pushState({},e,"/"!==e?"?"+e:"/");else{const t=new URLSearchParams(window.location.search).keys().next();t.done||(e=t.value)}if(e&&"/"!==e){try{await Clara.loadProjectHtml(e)}catch(t){console.error("Errore nel caricamento del progetto",e,t)}Clara.showProject(e)}else Clara.showProject(null)}static async loadProjectHtml(e){const t=`[data-project="${e}"]`;let i=document.querySelector(t);const a=await fetch(`data/${e}.html`,{cache:"no-cache"});if(!a.ok)return void console.warn(`Impossibile caricare data/${e}.html (status ${a.status})`);const s=await a.text();i||(i=document.createElement("div"),i.className="project",i.setAttribute("data-project",e),document.body.appendChild(i)),i.innerHTML=s;const o=i.querySelector(".project-content");o&&(o.classList.remove("project-content--entered"),o.classList.add("project-content--will-animate"),o.offsetWidth,o.classList.add("project-content--entered"),o.addEventListener("transitionend",(()=>{o.classList.remove("project-content--will-animate")}),{once:!0}));}static showProject(e){let t=document.querySelector("body");if(!e)return t.classList.remove("no-overflow"),void document.querySelector(".project.selected")?.classList.remove("selected");let i=document.querySelector(`[data-project="${e}"]`);if(!i)return;i.classList.add("selected");let a=document.createElement("div");a.className="project-close",a.setAttribute("onclick","Clara.view('/')"),a.innerHTML="✕",i.appendChild(a),t.classList.add("no-overflow"),new Lightbox(i.querySelectorAll(".project-media"))}static scrollTo(){document.querySelector(".work.selected").querySelector(".work-gallery").scroll({top:0,behavior:"smooth"})}static scrollDown(e){let t=document.querySelector(".work.selected"),i=t.querySelector(".work-gallery").scrollTop+500,a=t.querySelector(".work-gallery");e.classList.contains("is-bottom")&&(i=0),a.scroll({top:i,behavior:"smooth"})}static setYear(){document.querySelector(".year").innerHTML=(new Date).getFullYear()}static getColumnCount(e){return e<768?1:e<1024?2:e<1440?3:4}static isMobile(){return window.matchMedia("(max-width: 425px)").matches}static renderProjects(){let e=document.querySelector(".project-list");e.innerHTML="";const t=e.getBoundingClientRect().width,i=Clara.getColumnCount(t),a=[];for(let t=0;t<i;t++){const t=document.createElement("div");t.className="project-column",e.appendChild(t),a.push(t)}Clara.projects.forEach(((e,t)=>{const s=document.createElement("div");s.className="project-item",e.id?s.setAttribute("onclick",`Clara.view('${e.id}')`):s.classList.add("intro");const o=e.img||e.video?Math.floor((Clara.isMobile()?200:300)+300*Math.random()):10,l=e.img?`<div class="project-img-container"><div class="project-img" style="height:${o}px;background-image: url(${e.img})"></div></div>`:"",n=e.video?`<div class="project-img-container" style="height:${o}px;"><video class="project-video" autoplay muted loop playsinline  src="${e.video}"></video></div>`:"",r=e.year?'<div class="project-item-year">'+e.year+"</div>":"",d=e.title?'<div class="project-item-title">'+e.title+"</div>":"";s.innerHTML=`${l}${n}${d}${r}`,a[t%i].appendChild(s)}))}}class Lightbox{constructor(e){this.mediaElements=Array.from(e),this.currentIndex=0,this.buildOverlay(),this.attachEvents()}buildOverlay(){this.overlay=document.createElement("div"),this.overlay.className="lightbox-overlay",this.mediaWrapper=document.createElement("div"),this.mediaWrapper.className="lightbox-media-wrapper",this.overlay.appendChild(this.mediaWrapper),this.imgElement=document.createElement("img"),this.imgElement.style.display="none",this.mediaWrapper.appendChild(this.imgElement),this.videoElement=document.createElement("video"),this.videoElement.style.display="none",this.videoElement.setAttribute("playsinline",""),this.videoElement.setAttribute("muted",""),this.mediaWrapper.appendChild(this.videoElement),this.videoOverlay=document.createElement("div"),this.videoOverlay.className="lightbox-video-overlay",this.videoOverlay.style.display="none",this.mediaWrapper.appendChild(this.videoOverlay),this.iconPlay=document.createElement("div"),this.iconPlay.className="lightbox-video-icon play",this.videoOverlay.appendChild(this.iconPlay),this.iconPause=document.createElement("div"),this.iconPause.className="lightbox-video-icon pause",this.iconPause.style.display="none",this.videoOverlay.appendChild(this.iconPause),this.btnClose=document.createElement("div"),this.btnClose.className="lightbox-btn lightbox-close",this.btnClose.innerText="✕",this.overlay.appendChild(this.btnClose),this.btnPrev=document.createElement("div"),this.btnPrev.className="lightbox-btn lightbox-prev",this.btnPrev.innerText="⟵",this.overlay.appendChild(this.btnPrev),this.btnNext=document.createElement("div"),this.btnNext.className="lightbox-btn lightbox-next",this.btnNext.innerText="⟶",this.overlay.appendChild(this.btnNext),document.body.appendChild(this.overlay)}attachEvents(){this.mediaElements.forEach(((e,t)=>{e.addEventListener("click",(()=>this.show(t)))})),this.overlay.addEventListener("click",(e=>{e.target!==this.overlay&&e.target!==this.btnClose||this.hide()})),this.btnNext.addEventListener("click",(e=>{e.stopPropagation(),this.next()})),this.btnPrev.addEventListener("click",(e=>{e.stopPropagation(),this.prev()})),document.addEventListener("keydown",(e=>{this.overlay.classList.contains("show")&&("Escape"===e.key&&this.hide(),"ArrowRight"===e.key&&this.next(),"ArrowLeft"===e.key&&this.prev())})),this.videoOverlay.addEventListener("click",(e=>{e.stopPropagation(),this.videoElement.paused?this.videoElement.play():this.videoElement.pause()})),this.videoOverlay.addEventListener("mouseenter",(()=>{this.videoElement.paused||(this.iconPause.style.display="")})),this.videoOverlay.addEventListener("mouseleave",(()=>{this.videoElement.paused||(this.iconPause.style.display="none")})),this.videoElement.addEventListener("mouseenter",(()=>{this.videoElement.paused||(this.iconPause.style.display="")})),this.videoElement.addEventListener("mouseleave",(()=>{this.videoElement.paused||(this.iconPause.style.display="none")})),this.videoElement.addEventListener("play",(()=>{this.iconPlay.style.display="none",this.iconPause.style.display="none"})),this.videoElement.addEventListener("pause",(()=>{this.iconPlay.style.display="",this.iconPause.style.display="none"}))}show(e){this.currentIndex=e;const t=this.mediaElements[this.currentIndex];if(this.imgElement.style.display="none",this.videoElement.style.display="none",this.videoOverlay.style.display="none",this.videoElement.pause(),t.classList.contains("project-video")){let e=t.getAttribute("data-src")||"";this.videoElement.src=e||"",this.videoElement.style.display="",this.videoOverlay.style.display="",this.iconPlay.style.display="",this.iconPause.style.display="none",this.videoElement.play()}else this.imgElement.src=t.src,this.imgElement.style.display="";t.querySelector("img");this.overlay.classList.add("show")}hide(){this.overlay.classList.remove("show"),this.videoElement.pause()}next(){this.currentIndex=(this.currentIndex+1)%this.mediaElements.length,this.show(this.currentIndex)}prev(){this.currentIndex=(this.currentIndex-1+this.mediaElements.length)%this.mediaElements.length,this.show(this.currentIndex)}}Clara.init();